import { AIConfig } from '../AIConfig';

export type AIWeights = {
    SCORE_BASE_VALUE: number;
    SCORE_WIN_CONDITION: number;
    SCORE_TOWN: number;
    SCORE_ENEMY_LAND: number;
    SCORE_DISCONNECT_ENEMY: number;
    SCORE_DEFEND_BASE: number;
    SCORE_HILL: number;
    SCORE_BRIDGE: number;
    SCORE_EXPANSION: number;
    SCORE_AURA_MULTIPLIER: number;
    COST_PENALTY_MULTIPLIER: number;
    SCORE_LOOKAHEAD_TOWN: number;
    SCORE_LOOKAHEAD_BASE: number;
    STRATEGY_EARLY_TURN_LIMIT: number;
    STRATEGY_EARLY_EXPANSION_BONUS: number;
    STRATEGY_EARLY_FARM_BONUS: number;
    STRATEGY_BASE_UPGRADE_BONUS: number;
    STRATEGY_WALL_PRIORITY_BONUS: number;
    ECONOMY_BASE_INCOME: number;
    ECONOMY_BASE_INCOME_LEVEL: number;
    ECONOMY_FARM_BUILD: number;
    ECONOMY_FARM_UPGRADE: number;
    ECONOMY_FARM_LEVEL: number;
    ECONOMY_AURA_BONUS_MULT: number;
    DEFENSE_BASE_UPGRADE: number;
    DEFENSE_WALL_BUILD: number;
    DEFENSE_WALL_UPGRADE: number;
    DEFENSE_WATCHTOWER_BUILD: number;
    DEFENSE_WATCHTOWER_UPGRADE: number;
    DEFENSE_THREAT_MULT: number;
    DEFENSE_BASE_THREAT_RADIUS: number;
    DEFENSE_BASE_THREAT_SCORE: number;
    RECONNECT_DISCONNECTED_SCORE: number;
    MAX_MOVES_PER_TURN: number;
    RANDOM_NOISE: number;
};

export type AIProfile = {
    id: string;
    label?: string;
    weights?: Partial<AIWeights>;
};

export const DefaultAIWeights: AIWeights = {
    SCORE_BASE_VALUE: AIConfig.SCORE_BASE_VALUE,
    SCORE_WIN_CONDITION: AIConfig.SCORE_WIN_CONDITION,
    SCORE_TOWN: AIConfig.SCORE_TOWN,
    SCORE_ENEMY_LAND: AIConfig.SCORE_ENEMY_LAND,
    SCORE_DISCONNECT_ENEMY: AIConfig.SCORE_DISCONNECT_ENEMY,
    SCORE_DEFEND_BASE: AIConfig.SCORE_DEFEND_BASE,
    SCORE_HILL: AIConfig.SCORE_HILL,
    SCORE_BRIDGE: AIConfig.SCORE_BRIDGE,
    SCORE_EXPANSION: AIConfig.SCORE_EXPANSION,
    SCORE_AURA_MULTIPLIER: AIConfig.SCORE_AURA_MULTIPLIER,
    COST_PENALTY_MULTIPLIER: AIConfig.COST_PENALTY_MULTIPLIER,
    SCORE_LOOKAHEAD_TOWN: AIConfig.SCORE_LOOKAHEAD_TOWN,
    SCORE_LOOKAHEAD_BASE: AIConfig.SCORE_LOOKAHEAD_BASE,
    STRATEGY_EARLY_TURN_LIMIT: AIConfig.STRATEGY_EARLY_TURN_LIMIT,
    STRATEGY_EARLY_EXPANSION_BONUS: AIConfig.STRATEGY_EARLY_EXPANSION_BONUS,
    STRATEGY_EARLY_FARM_BONUS: AIConfig.STRATEGY_EARLY_FARM_BONUS,
    STRATEGY_BASE_UPGRADE_BONUS: AIConfig.STRATEGY_BASE_UPGRADE_BONUS,
    STRATEGY_WALL_PRIORITY_BONUS: AIConfig.STRATEGY_WALL_PRIORITY_BONUS,
    ECONOMY_BASE_INCOME: 120,
    ECONOMY_BASE_INCOME_LEVEL: 30,
    ECONOMY_FARM_BUILD: 90,
    ECONOMY_FARM_UPGRADE: 70,
    ECONOMY_FARM_LEVEL: 25,
    ECONOMY_AURA_BONUS_MULT: 200,
    DEFENSE_BASE_UPGRADE: 120,
    DEFENSE_WALL_BUILD: 110,
    DEFENSE_WALL_UPGRADE: 90,
    DEFENSE_WATCHTOWER_BUILD: 80,
    DEFENSE_WATCHTOWER_UPGRADE: 70,
    DEFENSE_THREAT_MULT: 120,
    DEFENSE_BASE_THREAT_RADIUS: 2,
    DEFENSE_BASE_THREAT_SCORE: 600,
    RECONNECT_DISCONNECTED_SCORE: 120,
    MAX_MOVES_PER_TURN: AIConfig.MAX_MOVES_PER_TURN,
    RANDOM_NOISE: 10
};

export const BaselineAIProfile: AIProfile = {
    id: 'baseline',
    label: 'Baseline',
    weights: {}
};

export const OptimizedAIProfile: AIProfile = {
    id: 'balanced_plus',
    label: 'Balanced Plus',
    weights: {
        SCORE_ENEMY_LAND: AIConfig.SCORE_ENEMY_LAND * 1.1,
        SCORE_TOWN: AIConfig.SCORE_TOWN * 1.2,
        SCORE_LOOKAHEAD_TOWN: AIConfig.SCORE_LOOKAHEAD_TOWN * 1.2,
        ECONOMY_FARM_BUILD: DefaultAIWeights.ECONOMY_FARM_BUILD * 1.2,
        DEFENSE_WALL_BUILD: DefaultAIWeights.DEFENSE_WALL_BUILD * 1.1,
        DEFENSE_THREAT_MULT: DefaultAIWeights.DEFENSE_THREAT_MULT * 1.1
    }
};

// SELFPLAY_TUNED_PROFILE_START
export const SelfPlayTunedProfile: AIProfile = {
    id: 'selfplay_tuned',
    label: 'Fortress Prime',
    weights: {
        SCORE_TOWN: 525.415,
        SCORE_ENEMY_LAND: 80.109,
        SCORE_DISCONNECT_ENEMY: 50.549,
        SCORE_DEFEND_BASE: 2384.841,
        SCORE_HILL: 59.368,
        SCORE_BRIDGE: 54.746,
        SCORE_EXPANSION: 20.903,
        SCORE_AURA_MULTIPLIER: 217.659,
        COST_PENALTY_MULTIPLIER: 0.485,
        SCORE_LOOKAHEAD_TOWN: 119.793,
        SCORE_LOOKAHEAD_BASE: 196.422,
        ECONOMY_BASE_INCOME: 119.462,
        ECONOMY_BASE_INCOME_LEVEL: 25.667,
        ECONOMY_FARM_BUILD: 86.535,
        ECONOMY_FARM_UPGRADE: 62.931,
        ECONOMY_FARM_LEVEL: 21.545,
        ECONOMY_AURA_BONUS_MULT: 199.132,
        DEFENSE_BASE_UPGRADE: 99.234,
        DEFENSE_WALL_BUILD: 105.363,
        DEFENSE_WALL_UPGRADE: 99.616,
        DEFENSE_WATCHTOWER_BUILD: 73.148,
        DEFENSE_WATCHTOWER_UPGRADE: 61.344,
        DEFENSE_THREAT_MULT: 98.051,
        RECONNECT_DISCONNECTED_SCORE: 116.514,
        STRATEGY_EARLY_EXPANSION_BONUS: 41.446,
        STRATEGY_EARLY_FARM_BONUS: 67.168,
        STRATEGY_BASE_UPGRADE_BONUS: 73.436,
        STRATEGY_WALL_PRIORITY_BONUS: 79.397
    }
};
// SELFPLAY_TUNED_PROFILE_END

export const SelfPlayTunedProfileAlt1: AIProfile = {
    id: 'selfplay_tuned_alt_1',
    label: 'Aura Sentinel',
    weights: {
        SCORE_TOWN: 505.149,
        SCORE_ENEMY_LAND: 80.094,
        SCORE_DISCONNECT_ENEMY: 53.263,
        SCORE_DEFEND_BASE: 1761.73,
        SCORE_HILL: 50.842,
        SCORE_BRIDGE: 49.698,
        SCORE_EXPANSION: 16.036,
        SCORE_AURA_MULTIPLIER: 233.674,
        COST_PENALTY_MULTIPLIER: 0.594,
        SCORE_LOOKAHEAD_TOWN: 88.402,
        SCORE_LOOKAHEAD_BASE: 234.72,
        ECONOMY_BASE_INCOME: 114.371,
        ECONOMY_BASE_INCOME_LEVEL: 24.268,
        ECONOMY_FARM_BUILD: 73.855,
        ECONOMY_FARM_UPGRADE: 68.684,
        ECONOMY_FARM_LEVEL: 27.842,
        ECONOMY_AURA_BONUS_MULT: 210.502,
        DEFENSE_BASE_UPGRADE: 119.09,
        DEFENSE_WALL_BUILD: 105.893,
        DEFENSE_WALL_UPGRADE: 79.172,
        DEFENSE_WATCHTOWER_BUILD: 95.612,
        DEFENSE_WATCHTOWER_UPGRADE: 82.464,
        DEFENSE_THREAT_MULT: 108.918,
        RECONNECT_DISCONNECTED_SCORE: 141.354,
        STRATEGY_EARLY_EXPANSION_BONUS: 45.654,
        STRATEGY_EARLY_FARM_BONUS: 71.615,
        STRATEGY_BASE_UPGRADE_BONUS: 86.352,
        STRATEGY_WALL_PRIORITY_BONUS: 106.001
    }
};

export const SelfPlayTunedProfileAlt2: AIProfile = {
    id: 'selfplay_tuned_alt_2',
    label: 'Rapid Builder',
    weights: {
        SCORE_TOWN: 447.568,
        SCORE_ENEMY_LAND: 96.165,
        SCORE_DISCONNECT_ENEMY: 48.056,
        SCORE_DEFEND_BASE: 1956.934,
        SCORE_HILL: 44.455,
        SCORE_BRIDGE: 63.865,
        SCORE_EXPANSION: 23.516,
        SCORE_AURA_MULTIPLIER: 184.443,
        COST_PENALTY_MULTIPLIER: 0.413,
        SCORE_LOOKAHEAD_TOWN: 95.197,
        SCORE_LOOKAHEAD_BASE: 189.017,
        ECONOMY_BASE_INCOME: 110.949,
        ECONOMY_BASE_INCOME_LEVEL: 24.258,
        ECONOMY_FARM_BUILD: 98.021,
        ECONOMY_FARM_UPGRADE: 62.512,
        ECONOMY_FARM_LEVEL: 22.733,
        ECONOMY_AURA_BONUS_MULT: 167.877,
        DEFENSE_BASE_UPGRADE: 141.606,
        DEFENSE_WALL_BUILD: 130.164,
        DEFENSE_WALL_UPGRADE: 102.886,
        DEFENSE_WATCHTOWER_BUILD: 75.369,
        DEFENSE_WATCHTOWER_UPGRADE: 57.423,
        DEFENSE_THREAT_MULT: 119.056,
        RECONNECT_DISCONNECTED_SCORE: 96.963,
        STRATEGY_EARLY_EXPANSION_BONUS: 38.469,
        STRATEGY_EARLY_FARM_BONUS: 51.675,
        STRATEGY_BASE_UPGRADE_BONUS: 88.113,
        STRATEGY_WALL_PRIORITY_BONUS: 75.912
    }
};

export const SelfPlayTunedProfileAlt3: AIProfile = {
    id: 'selfplay_tuned_alt_3',
    label: 'Wall Command',
    weights: {
        SCORE_TOWN: 402.341,
        SCORE_ENEMY_LAND: 82.478,
        SCORE_DISCONNECT_ENEMY: 59.538,
        SCORE_DEFEND_BASE: 2159.223,
        SCORE_HILL: 50.429,
        SCORE_BRIDGE: 57.733,
        SCORE_EXPANSION: 19.73,
        SCORE_AURA_MULTIPLIER: 179.194,
        COST_PENALTY_MULTIPLIER: 0.511,
        SCORE_LOOKAHEAD_TOWN: 109.193,
        SCORE_LOOKAHEAD_BASE: 180.625,
        ECONOMY_BASE_INCOME: 103.486,
        ECONOMY_BASE_INCOME_LEVEL: 33.169,
        ECONOMY_FARM_BUILD: 90.662,
        ECONOMY_FARM_UPGRADE: 61.52,
        ECONOMY_FARM_LEVEL: 23.68,
        ECONOMY_AURA_BONUS_MULT: 183.46,
        DEFENSE_BASE_UPGRADE: 121.667,
        DEFENSE_WALL_BUILD: 101.039,
        DEFENSE_WALL_UPGRADE: 107.206,
        DEFENSE_WATCHTOWER_BUILD: 71.921,
        DEFENSE_WATCHTOWER_UPGRADE: 80.578,
        DEFENSE_THREAT_MULT: 105.158,
        RECONNECT_DISCONNECTED_SCORE: 102.896,
        STRATEGY_EARLY_EXPANSION_BONUS: 34.474,
        STRATEGY_EARLY_FARM_BONUS: 54.983,
        STRATEGY_BASE_UPGRADE_BONUS: 81.533,
        STRATEGY_WALL_PRIORITY_BONUS: 99.427
    }
};

export const SelfPlayTunedProfileAlt4: AIProfile = {
    id: 'selfplay_tuned_alt_4',
    label: 'Frontier Warden',
    weights: {
        SCORE_TOWN: 526.279,
        SCORE_ENEMY_LAND: 85.773,
        SCORE_DISCONNECT_ENEMY: 55.047,
        SCORE_DEFEND_BASE: 1910.619,
        SCORE_HILL: 46.794,
        SCORE_BRIDGE: 48.472,
        SCORE_EXPANSION: 23.504,
        SCORE_AURA_MULTIPLIER: 201.069,
        COST_PENALTY_MULTIPLIER: 0.438,
        SCORE_LOOKAHEAD_TOWN: 117.341,
        SCORE_LOOKAHEAD_BASE: 196.376,
        ECONOMY_BASE_INCOME: 96.285,
        ECONOMY_BASE_INCOME_LEVEL: 27.279,
        ECONOMY_FARM_BUILD: 87.039,
        ECONOMY_FARM_UPGRADE: 72.219,
        ECONOMY_FARM_LEVEL: 28.462,
        ECONOMY_AURA_BONUS_MULT: 187.269,
        DEFENSE_BASE_UPGRADE: 115.956,
        DEFENSE_WALL_BUILD: 125.332,
        DEFENSE_WALL_UPGRADE: 77.819,
        DEFENSE_WATCHTOWER_BUILD: 86.43,
        DEFENSE_WATCHTOWER_UPGRADE: 64.918,
        DEFENSE_THREAT_MULT: 127.304,
        RECONNECT_DISCONNECTED_SCORE: 132.416,
        STRATEGY_EARLY_EXPANSION_BONUS: 39.693,
        STRATEGY_EARLY_FARM_BONUS: 60.036,
        STRATEGY_BASE_UPGRADE_BONUS: 89.956,
        STRATEGY_WALL_PRIORITY_BONUS: 100.713
    }
};

export const SelfPlayTunedProfileAlt5: AIProfile = {
    id: 'selfplay_tuned_alt_5',
    label: 'Aura Harvester',
    weights: {
        SCORE_TOWN: 479.632,
        SCORE_ENEMY_LAND: 104.136,
        SCORE_DISCONNECT_ENEMY: 50.526,
        SCORE_DEFEND_BASE: 1759.147,
        SCORE_HILL: 56.076,
        SCORE_BRIDGE: 60.773,
        SCORE_EXPANSION: 21.715,
        SCORE_AURA_MULTIPLIER: 176.746,
        COST_PENALTY_MULTIPLIER: 0.428,
        SCORE_LOOKAHEAD_TOWN: 101.903,
        SCORE_LOOKAHEAD_BASE: 191.302,
        ECONOMY_BASE_INCOME: 120.395,
        ECONOMY_BASE_INCOME_LEVEL: 26.421,
        ECONOMY_FARM_BUILD: 88.947,
        ECONOMY_FARM_UPGRADE: 73.574,
        ECONOMY_FARM_LEVEL: 20.882,
        ECONOMY_AURA_BONUS_MULT: 235.297,
        DEFENSE_BASE_UPGRADE: 129.274,
        DEFENSE_WALL_BUILD: 126.544,
        DEFENSE_WALL_UPGRADE: 89.543,
        DEFENSE_WATCHTOWER_BUILD: 67.55,
        DEFENSE_WATCHTOWER_UPGRADE: 77.353,
        DEFENSE_THREAT_MULT: 107.871,
        RECONNECT_DISCONNECTED_SCORE: 138.812,
        STRATEGY_EARLY_EXPANSION_BONUS: 35.177,
        STRATEGY_EARLY_FARM_BONUS: 62.529,
        STRATEGY_BASE_UPGRADE_BONUS: 70.308,
        STRATEGY_WALL_PRIORITY_BONUS: 79.368
    }
};

export const SelfPlayTunedProfileAlt6: AIProfile = {
    id: 'selfplay_tuned_alt_6',
    label: 'Town Pioneer',
    weights: {
        SCORE_TOWN: 550.522,
        SCORE_ENEMY_LAND: 95.4,
        SCORE_DISCONNECT_ENEMY: 51.952,
        SCORE_DEFEND_BASE: 1829.693,
        SCORE_HILL: 48.549,
        SCORE_BRIDGE: 52.603,
        SCORE_EXPANSION: 21.821,
        SCORE_AURA_MULTIPLIER: 228.603,
        COST_PENALTY_MULTIPLIER: 0.483,
        SCORE_LOOKAHEAD_TOWN: 118.423,
        SCORE_LOOKAHEAD_BASE: 179.777,
        ECONOMY_BASE_INCOME: 103.926,
        ECONOMY_BASE_INCOME_LEVEL: 27.34,
        ECONOMY_FARM_BUILD: 92.105,
        ECONOMY_FARM_UPGRADE: 62.044,
        ECONOMY_FARM_LEVEL: 22.097,
        ECONOMY_AURA_BONUS_MULT: 237.548,
        DEFENSE_BASE_UPGRADE: 110.879,
        DEFENSE_WALL_BUILD: 94.443,
        DEFENSE_WALL_UPGRADE: 83.702,
        DEFENSE_WATCHTOWER_BUILD: 67.255,
        DEFENSE_WATCHTOWER_UPGRADE: 64.682,
        DEFENSE_THREAT_MULT: 114.064,
        RECONNECT_DISCONNECTED_SCORE: 140.037,
        STRATEGY_EARLY_EXPANSION_BONUS: 46.842,
        STRATEGY_EARLY_FARM_BONUS: 69.573,
        STRATEGY_BASE_UPGRADE_BONUS: 94.6,
        STRATEGY_WALL_PRIORITY_BONUS: 82.94
    }
};

export const RandomAiProfiles: AIProfile[] = [
    SelfPlayTunedProfile,
    SelfPlayTunedProfileAlt1,
    SelfPlayTunedProfileAlt2,
    SelfPlayTunedProfileAlt3,
    SelfPlayTunedProfileAlt4,
    SelfPlayTunedProfileAlt5,
    SelfPlayTunedProfileAlt6
];

export const DefaultAIProfile: AIProfile = OptimizedAIProfile;

export const mergeAIWeights = (overrides?: Partial<AIWeights>): AIWeights => {
    return {
        ...DefaultAIWeights,
        ...(overrides || {})
    };
};
